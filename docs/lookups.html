<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MLD - Lookups</title>

  <link href="/assets/styles/salesforce-lightning-design-system.min.css" rel="stylesheet">
  <link href="styles/style.css" rel="stylesheet">
</head>
<body>

<div id="app">

</div>

<script src="mithril.js"></script>
<script src="bundle.js"></script>
<script src="faker.min.js"></script>
<script src="helpers.js"></script>

<script>

  var lookupData = [
    {
      "description": "Vandervoort Avenue",
      "name": "Limozen",
      "href": "57d88125365a185fc0259aa2"
    },
    {
      "description": "Crown Street",
      "name": "Nurplex",
      "href": "57d881252f28b431a3a2d43b"
    },
    {
      "description": "Banner Avenue",
      "name": "Equitax",
      "href": "57d881254d0e3aa39c43440a"
    },
    {
      "description": "Varet Street",
      "name": "Zaphire",
      "href": "57d88125bc03230f0ffb1340"
    },
    {
      "description": "Cherry Street",
      "name": "Xiix",
      "href": "57d88125d2a464ec65e06e13"
    },
    {
      "description": "Hanson Place",
      "name": "Columella",
      "href": "57d881256f43bf4c51c1669d"
    },
    {
      "description": "Amherst Street",
      "name": "Automon",
      "href": "57d881255533ec4e695e9fe7"
    },
    {
      "description": "Norman Avenue",
      "name": "Sustenza",
      "href": "57d881258d35fa142ab4180b"
    },
    {
      "description": "Commercial Street",
      "name": "Digitalus",
      "href": "57d88125f84493f7986896bd"
    },
    {
      "description": "Lloyd Court",
      "name": "Applideck",
      "href": "57d881259962ab12c16eee04"
    }
  ];

  var searchTerm = m.prop("");

  var lookupSelected = m.prop(false);

  var getCat = function (id) {
    console.log("callback")
    console.log(this.value())
  };

  m.mount(document.getElementById("app"), {
    view: function () {
      return m(".navigation"),
              m("main", [
                m(".masthead", [
                  m("h1.", "Menus"),
                ]),
                m(".content", [
                  m("section", [
                    m("h2.slds-m-bottom--medium.desc", "Lookups"),
                    m(mlds.lookups, {
                      label: "Lookups Company",
                      placeholder: "Search companies",
                      query: searchTerm,
                      searchOninput: m.withAttr("value", searchTerm),
                      value: lookupSelected,
                      filter: function (item) {
                        return item.name.toLowerCase().indexOf(searchTerm) > -1 || item.description.toLowerCase().indexOf(searchTerm) > -1 ;
                      },
                      data: {
                        list: lookupData,
                        key: "href"
                      },
                      newButton: {
                        url: "/test/new",
                        label: "New Company"
                      },
                      callbackSelect: getCat,
                      callbackUnselect: getCat
                    }),
                    m("p", lookupSelected())
                  ])
                ])
              ])
    }
  });

</script>

</body>
</html>